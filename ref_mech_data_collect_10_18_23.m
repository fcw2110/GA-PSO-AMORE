function S0 = ref_mech_data_collect_10_18_23()
S0 = [];
samples = csvread('samples8.csv');
N = [];
A = ["m" "s"]
Lm = 6;
%runs = ["caltech_ref","f0am_yield_method_cycled_51","f0am_yield_method_cycled_103","f0am_yield_methodn_158","f0am_yield_method_cycled_218","f0am_yield_method_cycled_280","f0am_yield_methodn_317","f0am_yield_method_cycled_353"];%,"AMORE_263_1_OPT - Copy"];
runs = ["caltech_ref_no_background_6_7_23"];%["caltech_ref_6_7_23"];
org_nit = ["ISOP1CO2N3OOH4OH"; "ISOP1CO2OOH3N4OH"; "ISOP1OH2OOH3N4CO"; "ISOP1OH2N3OOH4CO"; "ISOP1OH2N3CO4OH"; "ISOP1CO2N3OOH4OOH"; "ISOP1CO2OOH3N4OOH"; "ISOP1CO2OOH3OOH4N"; "ISOP1OOH2OOH3N4CO"; "ISOP1OOH2N3OOH4CO"; "ISOP1N2OOH3OOH4CO"; "ISOP1OOH23O3OH4N"; "ISOP1N2OOH34O4OH"; "ISOP1OH12O3OOH4N"; "ISOP1OH2OOH3OH4N"; "ISOP1OH2N3OH4OOH"; "ISOP1N2OH3OOH4OH"; "ISOP1OOH2OH3N4OH"; "ISOP1OH2OOH3N4OH"; "ISOP1OH2N3OOH4OH"; "ISOP1N2OOH3OH4CO"; "ISOP1CO2OH3OOH4N"; "ISOP1OOH2OH3CO4N"; "ISOP1N4R4OH"; "ISOP1OH1R4N"; "ISOP3OH3R4N"; "ISOP1OOH2R3CO4N"; "ISOP1OH2OH3N4CO"; "ISOP1CO2N3OH4OH"; "ISOP1OH2N3R4OH"; "ISOP1OH2N3OH4N"; "ISOP1OH2N3N4OH"; "ISOP1CO2N3OH4OOH"; "ISOP1OH2R3N4OH"; "ISOP1N2OH3N4OH"; "ISOP1OOH2OH3N4CO"; "ISOP1N2OOH"; "ISOP1N4OOH"; "ISOP3OOH4N"; "ISOP1OOH4N"; "ISOP1N2OH"; "ISOP3CO4N"; "ISOP1CO4N"; "ISOP1O4N"; "ISOP1N4CO"; "ISOP1N4O"; "ISOP3OH4N"; "ISOP1N2N"; "ISOP1N4N"; "ISOP3N4N"; "ISOP1N253O4OH"; "ISOP1N253N4OH"; "ISOP1N253OOH4OH"; "ISOP1N253CO4OH"; "ISOP1N253OH4OH"; "ISOP1N2OOH3R4OH"; "ISOP1N23O4OH"; "ISOP1N2OH3R4OOH"; "ISOP1N2OH34O"; "ISOP1N2R3OH4OOH"; "ISOP1OH2R3OOH4N"; "ISOP1OH23O4N"; "ISOP1OOH2R3OH4N"; "ISOP12O3OH4N"; "ISOP1OOH2OH3R4N"; "ISOP1N2OOH3N4OH"; "ISOP1N2OOH3OOH4OH"; "ISOP1N2OOH3OH4N"; "ISOP1N2OOH3OH4OOH"; "ISOP1N2OH3N4OOH"; "ISOP1N2OH3OOH4OOH"; "ISOP1N2N3OH4OOH"; "ISOP1OH2N3OOH4N"; "ISOP1OH2OOH3OOH4N"; "ISOP1N2OH3OOH4N"; "ISOP1OOH2OH3OOH4N"; "ISOP1OOH2N3OH4N"; "ISOP1OOH2OOH3OH4N"; "ISOP1OO2OOH3OH4N"; "ISOP1N2N3OOH4OH"; "ISOP1OH2OOH3N4N"; "ISOP1N23O4OH4R"; "ISOP1N23O4CO"; "ISOP1OH1R23O4N"; "ISOP1CO23O4N"; "ISOP1N2OH3CO4OOH"; "ISOP12O3OH3R4N"; "ISOP12O3CO4N"; "ISOP1N2OH3CO4N"; "ISOP1OH2OOH3CO4N"; "ISOP1N4R4CO"; "ISOP1N4CO4OOH"; "ISOP1N4CO4OH"; "ISOP1CO1R4N"; "ISOP1CO1OOH4N"; "ISOP1CO1OH4N"; "ISOP1N2R3OH4CO"; "ISOP1CO2OH3R4N"; "ISOP1N2OH3OOH4CO"; "ISOP1CO2OOH3OH4N"; "ISOP1N2R3OH4OH"; "ISOP1OH2OH3R4N"; "ISOP1N2OOH3OH4OH"; "ISOP1OH2OH3OOH4N"; "ISOP1N2OH3OH4OOH"; "ISOP1OOH2OH3OH4N"; "ISOP1OOH2OH3N4N"; "ISOP1OH2N3CO4N"; "ISOP1N2N3CO4OH"; "ISOP1OH2OH3N4N"; "ISOP1N2OH3OH4N"; "ISOP1N2N3OH4OH"; "ISOP1CO2N3OH4N"; "ISOP1N2OH3N4CO"; "ISOP1N4PAN"; "ISOP1PAN4N";"ISOP1PAN4OH";"ISOP1OH4PAN"];
nit = 'ISOP1OH2N+ISOP1OH4N+ISOP1N4OH+ISOP3N4OH+ISOP1CO2N3OOH4OH+ISOP1CO2OOH3N4OH+ISOP1OH2OOH3N4CO+ISOP1OH2N3OOH4CO+ISOP1OH2N3CO4OH+ISOP1CO2N3OOH4OOH+ISOP1CO2OOH3N4OOH+ISOP1CO2OOH3OOH4N+ISOP1OOH2OOH3N4CO+ISOP1OOH2N3OOH4CO+ISOP1N2OOH3OOH4CO+ISOP1OOH23O3OH4N+ISOP1N2OOH34O4OH+ISOP1OH12O3OOH4N+ISOP1OH2OOH3OH4N+ISOP1OH2N3OH4OOH+ISOP1N2OH3OOH4OH+ISOP1OOH2OH3N4OH+ISOP1OH2OOH3N4OH+ISOP1OH2N3OOH4OH+ISOP1N2OOH3OH4CO+ISOP1CO2OH3OOH4N+ISOP1OOH2OH3CO4N+ISOP1N4R4OH+ISOP1OH1R4N+ISOP3OH3R4N+ISOP1OOH2R3CO4N+ISOP1OH2OH3N4CO+ISOP1CO2N3OH4OH+ISOP1OH2N3R4OH+ISOP1OH2N3OH4N+ISOP1OH2N3N4OH+ISOP1CO2N3OH4OOH+ISOP1OH2R3N4OH+ISOP1N2OH3N4OH+ISOP1OOH2OH3N4CO+ISOP1N2OOH+ISOP1N4OOH+ISOP3OOH4N+ISOP1OOH4N+ISOP1N2OH+ISOP3CO4N+ISOP1CO4N+ISOP1O4N+ISOP1N4CO+ISOP1N4O+ISOP3OH4N+ISOP1N2N+ISOP1N4N+ISOP3N4N+ISOP1N253O4OH+ISOP1N253N4OH+ISOP1N253OOH4OH+ISOP1N253CO4OH+ISOP1N253OH4OH+ISOP1N2OOH3R4OH+ISOP1N23O4OH+ISOP1N2OH3R4OOH+ISOP1N2OH34O+ISOP1N2R3OH4OOH+ISOP1OH2R3OOH4N+ISOP1OH23O4N+ISOP1OOH2R3OH4N+ISOP12O3OH4N+ISOP1OOH2OH3R4N+ISOP1N2OOH3N4OH+ISOP1N2OOH3OOH4OH+ISOP1N2OOH3OH4N+ISOP1N2OOH3OH4OOH+ISOP1N2OH3N4OOH+ISOP1N2OH3OOH4OOH+ISOP1N2N3OH4OOH+ISOP1OH2N3OOH4N+ISOP1OH2OOH3OOH4N+ISOP1N2OH3OOH4N+ISOP1OOH2OH3OOH4N+ISOP1OOH2N3OH4N+ISOP1OOH2OOH3OH4N+ISOP1OO2OOH3OH4N+ISOP1N2N3OOH4OH+ISOP1OH2OOH3N4N+ISOP1N23O4OH4R+ISOP1N23O4CO+ISOP1OH1R23O4N+ISOP1CO23O4N+ISOP1N2OH3CO4OOH+ISOP12O3OH3R4N+ISOP12O3CO4N+ISOP1N2OH3CO4N+ISOP1OH2OOH3CO4N+ISOP1N4R4CO+ISOP1N4CO4OOH+ISOP1N4CO4OH+ISOP1CO1R4N+ISOP1CO1OOH4N+ISOP1CO1OH4N+ISOP1N2R3OH4CO+ISOP1CO2OH3R4N+ISOP1N2OH3OOH4CO+ISOP1CO2OOH3OH4N+ISOP1N2R3OH4OH+ISOP1OH2OH3R4N+ISOP1N2OOH3OH4OH+ISOP1OH2OH3OOH4N+ISOP1N2OH3OH4OOH+ISOP1OOH2OH3OH4N+ISOP1OOH2OH3N4N+ISOP1OH2N3CO4N+ISOP1N2N3CO4OH+ISOP1OH2OH3N4N+ISOP1N2OH3OH4N+ISOP1N2N3OH4OH+ISOP1CO2N3OH4N+ISOP1N2OH3N4CO+ISOP1N4PAN+ISOP1PAN4N+ISOP1PAN4OH+ISOP1OH4PAN';
nit2 = 'ISOP1OH2N+ISOP1OH4N + ISOP1N4OH +  ISOP3N4OH + ISOPNOO1 +  ISOPNOO2 +  INO2B + INO2D +  INPB +  INPD +  ISOP1N4CO +  ISOP1CO4N +  ISOP3CO4N +  IHNB +  INO +  IDN +  IDHNBOO + IDHNDOO1 +  IDHNDOO2 +  IHPNBOO +  IHPNDOO +  IHNE +  ICNE +  IHNEOO +  ICN1OO +  ICN2OO +  ICN3OO + ICN4OO +  ICN5OO +  ICHNP +  IHNDP +  IDHDN +  IDHPN +  IDHCN + IHPDN +  ICHDN +  IHNPE + IDNOO'
IEPO = 'IEPOXt + IEPOXc + IEPOXD'
IEP  = 'ISOP1OH23O4OHt + ISOP1OH23O4OHc + ISOP1OH2OH34O'
Lr = length(runs);
org_nit = ["ISOP1OH2N";"ISOP1OH4N";"ISOP1N4OH";"ISOP3N4OH";"ISOP1CO2N3OOH4OH"; "ISOP1CO2OOH3N4OH"; "ISOP1OH2OOH3N4CO"; "ISOP1OH2N3OOH4CO"; "ISOP1OH2N3CO4OH"; "ISOP1CO2N3OOH4OOH"; "ISOP1CO2OOH3N4OOH"; "ISOP1CO2OOH3OOH4N"; "ISOP1OOH2OOH3N4CO"; "ISOP1OOH2N3OOH4CO"; "ISOP1N2OOH3OOH4CO"; "ISOP1OOH23O3OH4N"; "ISOP1N2OOH34O4OH"; "ISOP1OH12O3OOH4N"; "ISOP1OH2OOH3OH4N"; "ISOP1OH2N3OH4OOH"; "ISOP1N2OH3OOH4OH"; "ISOP1OOH2OH3N4OH"; "ISOP1OH2OOH3N4OH"; "ISOP1OH2N3OOH4OH"; "ISOP1N2OOH3OH4CO"; "ISOP1CO2OH3OOH4N"; "ISOP1OOH2OH3CO4N"; "ISOP1N4R4OH"; "ISOP1OH1R4N"; "ISOP3OH3R4N"; "ISOP1OOH2R3CO4N"; "ISOP1OH2OH3N4CO"; "ISOP1CO2N3OH4OH"; "ISOP1OH2N3R4OH"; "ISOP1OH2N3OH4N"; "ISOP1OH2N3N4OH"; "ISOP1CO2N3OH4OOH"; "ISOP1OH2R3N4OH"; "ISOP1N2OH3N4OH"; "ISOP1OOH2OH3N4CO"; "ISOP1N2OOH"; "ISOP1N4OOH"; "ISOP3OOH4N"; "ISOP1OOH4N"; "ISOP1N2OH"; "ISOP3CO4N"; "ISOP1CO4N"; "ISOP1O4N"; "ISOP1N4CO"; "ISOP1N4O"; "ISOP3OH4N"; "ISOP1N2N"; "ISOP1N4N"; "ISOP3N4N"; "ISOP1N253O4OH"; "ISOP1N253N4OH"; "ISOP1N253OOH4OH"; "ISOP1N253CO4OH"; "ISOP1N253OH4OH"; "ISOP1N2OOH3R4OH"; "ISOP1N23O4OH"; "ISOP1N2OH3R4OOH"; "ISOP1N2OH34O"; "ISOP1N2R3OH4OOH"; "ISOP1OH2R3OOH4N"; "ISOP1OH23O4N"; "ISOP1OOH2R3OH4N"; "ISOP12O3OH4N"; "ISOP1OOH2OH3R4N"; "ISOP1N2OOH3N4OH"; "ISOP1N2OOH3OOH4OH"; "ISOP1N2OOH3OH4N"; "ISOP1N2OOH3OH4OOH"; "ISOP1N2OH3N4OOH"; "ISOP1N2OH3OOH4OOH"; "ISOP1N2N3OH4OOH"; "ISOP1OH2N3OOH4N"; "ISOP1OH2OOH3OOH4N"; "ISOP1N2OH3OOH4N"; "ISOP1OOH2OH3OOH4N"; "ISOP1OOH2N3OH4N"; "ISOP1OOH2OOH3OH4N"; "ISOP1OO2OOH3OH4N"; "ISOP1N2N3OOH4OH"; "ISOP1OH2OOH3N4N"; "ISOP1N23O4OH4R"; "ISOP1N23O4CO"; "ISOP1OH1R23O4N"; "ISOP1CO23O4N"; "ISOP1N2OH3CO4OOH"; "ISOP12O3OH3R4N"; "ISOP12O3CO4N"; "ISOP1N2OH3CO4N"; "ISOP1OH2OOH3CO4N"; "ISOP1N4R4CO"; "ISOP1N4CO4OOH"; "ISOP1N4CO4OH"; "ISOP1CO1R4N"; "ISOP1CO1OOH4N"; "ISOP1CO1OH4N"; "ISOP1N2R3OH4CO"; "ISOP1CO2OH3R4N"; "ISOP1N2OH3OOH4CO"; "ISOP1CO2OOH3OH4N"; "ISOP1N2R3OH4OH"; "ISOP1OH2OH3R4N"; "ISOP1N2OOH3OH4OH"; "ISOP1OH2OH3OOH4N"; "ISOP1N2OH3OH4OOH"; "ISOP1OOH2OH3OH4N"; "ISOP1OOH2OH3N4N"; "ISOP1OH2N3CO4N"; "ISOP1N2N3CO4OH"; "ISOP1OH2OH3N4N"; "ISOP1N2OH3OH4N"; "ISOP1N2N3OH4OH"; "ISOP1CO2N3OH4N"; "ISOP1N2OH3N4CO"; "ISOP1N4PAN"; "ISOP1PAN4N";"ISOP1PAN4OH";"ISOP1OH4PAN"];
iep1 = ["ISOP1OH23O4OHt"; "ISOP1OH23O4OHc"; "ISOP1OH2OH34O"];
iep2 = ["IEPOXt"; "IEPOXc"; "IEPOXD"];
nit_2 = ["ISOP1OH2N"; "ISOP1OH4N";"ISOP1N4OH"; "ISOP3N4OH";"ISOPNOO1"; "ISOPNOO2"; "INO2B";"INO2D"; "INPB"; "INPD"; "ISOP1N4CO"; "ISOP1CO4N"; "ISOP3CO4N"; "IHNB"; "INO"; "IDN"; "IDHNBOO";"IDHNDOO1"; "IDHNDOO2"; "IHPNBOO"; "IHPNDOO"; "IHNE"; "ICNE"; "IHNEOO"; "ICN1OO"; "ICN2OO"; "ICN3OO";"ICN4OO"; "ICN5OO"; "ICHNP"; "IHNDP"; "IDHDN"; "IDHPN"; "IDHCN";"IHPDN"; "ICHDN"; "IHNPE";"IDNOO"];

mm_hcho = [];
mm_iepox = [];
mm_isopn = [];
mm_gly = [];
mm_macr = [];
mm_mgly = [];
mm_mvk = [];
mm_pan = [];
f = [];


for k = 1:Lr
    ChemFiles = {...
        'F0AM_isop_K_update(Met)';
        'F0AM_isop_J(Met,1)';
        runs(k);
        };
    for jj = 1:Lm
            %j = samples_to_read(jj)
            Met = {...
%  		names       values          
    		'P'         1000          ; %Pressure, mbar
    		'T'         292                ; %Temperature, K
    		'RH'        0                ; %Relative Humidity, percent
    		'LFlux'     'ExampleLightFlux.txt'     ; %Text file for radiation spectrum
            'SUN'       samples(jj,8)             ;
    		'jcorr'     samples(jj,8)              ; %light attenuation factor
    		};
        InitConc = {...
%   		names       conc(ppb)           HoldMe
        	'O2'        210000000             1;
        	'ISOP'      samples(jj,1)         0;
        	'NO3'       samples(jj,7)         1;
    		'OH'        samples(jj,2)         1; %10^6 molecules per CCH0         0;
            'O3'        samples(jj,6)         1;
            'NO'        samples(jj,5)         1;
        	'HO2'       samples(jj,3)         1;
            'CH3CO3'    samples(jj,9)         1;
            'CH3OO'     samples(jj,9)         1;
            %GLY'      0                   1;
            %'HKET'      0                   1;
            %'HO2'      0                   1;
            %'MGLY'      0                   1;
            %'UALP'      0                   1;
            %'HOM'      0                   1;
            %'ELHOM'      0                   1;
            %'ACD'      0                   1;
            %'ROH'      0                   1;
            %'ETHP'      0                   1;
            %'ALD'      0                   1;
            %'ORA2'      0                   1;
        	};
        BkgdConc = {...
%   names           values
        'DEFAULT'       0;   %0 for all zeros, 1 to use InitConc
        };

      
        ModelOptions.Verbose       = 3;
        ModelOptions.EndPointsOnly = 0;
        ModelOptions.LinkSteps     = 0;
        ModelOptions.IntTime       = 72*3600;
        ModelOptions.SavePath      = 'ChamberExampleOutput.mat';
        ModelOptions.GoParallel    = 0;
        x = F0AM_ModelCore(Met,InitConc,ChemFiles,BkgdConc,ModelOptions);
        S0 = [S0 x];
       
    end
    %if k>1
     %   fk = [];
      %  for j = 1:Lm
            %m2 = [];
            %m = [mm_hcho(j)/max(mm_hcho),mm_iepox(j)/max(mm_iepox),mm_isopn(j)/max(mm_isopn),mm_gly(j)/max(mm_gly),mm_macr(j)/max(mm_macr),mm_mgly(j)/max(mm_mgly),mm_mvk(j)/max(mm_mvk),mm_pan(j)/max(mm_pan)];
       %     fk = [fk Fitness_yield_Targeted(S0(j),S0(6*(k-1)+j),iep1,"IEPOX",org_nit,"ISOPN")];
        %end
        %f = [f; fk];
    %end
%fitness = mean(f)
end



